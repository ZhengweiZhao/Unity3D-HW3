3D Game Programming & Designï¼šæ¸¸æˆå¯¹è±¡ä¸å›¾å½¢åŸºç¡€

# æ¸¸æˆå¯¹è±¡ä¸å›¾å½¢åŸºç¡€
##  1ã€åŸºæœ¬æ“ä½œæ¼”ç»ƒã€å»ºè®®åšã€‘
- ä¸‹è½½ Fantasy Skybox FREEï¼Œ æ„å»ºè‡ªå·±çš„æ¸¸æˆåœºæ™¯
é¦–å…ˆåœ¨Asset Storeä¸­æœç´¢Fantasy Skybox FREEï¼Œç‚¹å‡»downloadä¸‹è½½ç„¶åimportå¯¼å…¥ã€‚
[åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191005171253521.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDM3NzY5MQ==,size_16,color_FFFFFF,t_70)
æˆ‘åœ¨å¯¼å…¥çš„æ—¶å€™é‡åˆ°äº†ä¸€ç‚¹å°é—®é¢˜ï¼Œå°±æ˜¯ç‚¹importæ€ä¹ˆéƒ½æ²¡æœ‰ååº”ã€‚ç„¶åè§£å†³æ–¹æ³•æ˜¯é‡æ–°å¯åŠ¨äº†ä¸€æ¬¡unityï¼Œç„¶ååœ¨æœ€ä¸Šé¢çš„èœå•æ æ‰¾åˆ°asset->import unity packageï¼Œä¼šå‡ºç°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ç•Œé¢ï¼Œç„¶åå¯¼å…¥å³å¯ã€‚
[åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191005170754421.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDM3NzY5MQ==,size_16,color_FFFFFF,t_70)
åœ¨ä¸‹é¢asseté‡Œå¯ä»¥çœ‹åˆ°Fantasy Skybox FREEå¯¼å…¥æˆåŠŸã€‚
[åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191005171823140.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDM3NzY5MQ==,size_16,color_FFFFFF,t_70)
ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨Materialsé‡Œé€‰æ‹©ä¸€ä¸ªçš„å¤©ç©ºç›’å­æ ·å¼:
[åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191005171926138.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDM3NzY5MQ==,size_16,color_FFFFFF,t_70)
åœ¨Assets ä¸Šä¸‹æ–‡èœå• -> create -> Material ç»™æ–°å»ºçš„skyboxèµ·å mysky
åœ¨ Inspector è§†å›¾ä¸­é€‰æ‹© Shader -> Skybox -> 6Sidedï¼Œç»™å„ä¸ªé¢åˆ†åˆ«è´´ä¸Šæˆ‘ä»¬ä¸‹è½½å¥½çš„èµ„æºè´´å›¾ã€‚
[åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191005191831525.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDM3NzY5MQ==,size_16,color_FFFFFF,t_70)
è¿™æ ·ä¸€ä¸ªskyboxå°±æ„å»ºå¥½äº†ï¼Œç„¶åæˆ‘ä»¬æŠŠå®ƒåº”ç”¨äºå½“å‰çš„æ¸¸æˆåœºæ™¯ä¸­ã€‚
ä¹‹åæˆ‘ä»¬å¼€å§‹åŠ terrainåœ°å½¢ç³»ç»Ÿã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191005192906187.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDM3NzY5MQ==,size_16,color_FFFFFF,t_70)
åŠ å…¥terrainæœ‰å¾ˆå¤šå¯ä»¥è°ƒçš„å‚æ•°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒTerrainæœ‰äº”ä¸ªå›¾æ ‡ï¼Œå·¦è¾¹ç¬¬ä¸€ä¸ªæ˜¯ç”¨æ¥å¢åŠ terrainçš„é‚»å±…terrainçš„ï¼Œä¹Ÿå°±æ˜¯æ‰©å……åœ°å½¢ï¼Œç¬¬äºŒä¸ªæ˜¯ç»˜åˆ¶terrainï¼Œæœ‰å¢åŠ åœ°å½¢é«˜ä½ï¼Œä¸Šé¢œè‰²æˆ–çº¹ç†ç­‰ç­‰åŠŸèƒ½ï¼Œç¬¬ä¸‰ä¸ªæ˜¯ç§æ ‘ï¼Œé€‰ä¸­æ ‘æœ¨çš„é¢„åˆ¶ä»¶ç„¶ååœ¨è¦ç§çš„åœ°æ–¹ç‚¹å‡»å³å¯ï¼Œç¬¬å››ä¸ªæ˜¯ç»˜åˆ¶ç»†èŠ‚ï¼Œå¯ä»¥æ”¹ç¬”åˆ·çš„å±æ€§ï¼Œæœ€åä¸€ä¸ªæ˜¯settingsï¼Œå°±æ˜¯è®¾ç½®æ•´å—terrainçš„å‚æ•°çš„ã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/2019100519310793.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDM3NzY5MQ==,size_16,color_FFFFFF,t_70)
ä¸Šè‰²åçš„terrainå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191005192756495.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDM3NzY5MQ==,size_16,color_FFFFFF,t_70)
å› ä¸ºè¿™ä¸ªçš„bakingè¿‡ç¨‹æ¯”è¾ƒé•¿ï¼Œä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæ²¡æœ‰ç­‰æ•´ä¸ªç§æ ‘æ•ˆæœå‡ºæ¥å°±å…³æ‰äº†ï¼ˆçœç‚¹ç”µï¼‰ï¼Œå¤§æ¦‚æ¸¸æˆåœºæ™¯åˆ¶ä½œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191005193724969.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDM3NzY5MQ==,size_16,color_FFFFFF,t_70)
- å†™ä¸€ä¸ªç®€å•çš„æ€»ç»“ï¼Œæ€»ç»“æ¸¸æˆå¯¹è±¡çš„ä½¿ç”¨

GameObject èœå•ä¸Šæ¸¸æˆå…ƒç´ æ˜¯æœ€åŸºç¡€çš„ã€‚å°½ç®¡å®é™…æ¸¸æˆç”Ÿäº§ä¸­æˆ‘ä»¬æ›´å¤šä¾èµ–æ¨¡å‹ã€é¢„åˆ¶ï¼Œä½†å®ƒä»¬éƒ½æ˜¯ç”±è¿™äº›å…ƒç´ æ„æˆã€‚åªæœ‰ç†è§£å®ƒä»¬æ‰èƒ½æ›´å¥½çš„æ§åˆ¶å®ƒä»¬ã€‚
Unity ä¸­å¸¸ç”¨çš„æ¸¸æˆå¯¹è±¡ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç±»ï¼š
>-  Empty ï¼šä¸æ˜¾ç¤ºå´æ˜¯æœ€å¸¸ç”¨å¯¹è±¡ä¹‹ä¸€ï¼Œé€šå¸¸æˆ‘ä»¬æŒ‚è½½è„šæœ¬éƒ½æ˜¯ç”¨emptyå¯¹è±¡
>ä½œä¸ºå­å¯¹è±¡çš„å®¹å™¨
åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ç©ºé—´
>- 3D ç‰©ä½“ï¼š3Dæ¸¸æˆä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå¯ä»¥æ”¹å˜å…¶ç½‘æ ¼å’Œæè´¨ï¼Œä¸‰è§’ç½‘æ ¼æ˜¯æ¸¸æˆç‰©ä½“è¡¨é¢çš„å”¯ä¸€å½¢å¼ã€‚
Â· åŸºç¡€ 3D ç‰©ä½“ï¼ˆPrimitive Objectï¼‰ï¼šç«‹æ–¹ä½“ï¼ˆCubeï¼‰ã€çƒä½“ï¼ˆSphereï¼‰ã€èƒ¶å›Šä½“ï¼ˆCapsuleï¼‰ã€åœ†æŸ±ä½“ï¼ˆSylinderï¼‰ã€å¹³é¢ï¼ˆPlaneï¼‰ã€å››è¾¹å½¢ï¼ˆQuadï¼‰
Â· æ„é€  3D ç‰©ä½“ï¼šç”±ä¸‰è§’å½¢ç½‘æ ¼æ„å»ºçš„ç‰©ä½“ï¼šå¦‚åœ°å½¢å¯ç”¨äºåˆ›å»ºé™†åœ°ã€å±±å·ã€æ²³æµã€å°å¾„ç­‰åœ°ç†ç»“æ„ï¼Œæ‰“é€ ç”¨æˆ·çš„æ¸¸æˆåœºæ™¯ã€‚
>- 2Dç‰©ä½“ï¼šæ¸¸æˆä¸­çš„äºŒç»´ç‰©ä½“ã€‚
>- Camera æ‘„åƒæœºï¼Œè§‚å¯Ÿæ¸¸æˆä¸–ç•Œçš„çª—å£
>- Light å…‰çº¿ï¼Œæ¸¸æˆä¸–ç•Œçš„å…‰æºï¼Œå…‰ä¸å½±æ˜¯è®©æ¸¸æˆä¸–ç•Œå¯Œæœ‰é­…åŠ›ã€‚ç¯å…‰æ˜¯æ¯ä¸ªåœºæ™¯çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ç½‘æ ¼å’Œçº¹ç†å®šä¹‰äº†åœºæ™¯çš„å½¢çŠ¶å’Œå¤–è§‚ï¼Œè€Œç¯å…‰å®šä¹‰äº†3Dç¯å¢ƒçš„é¢œè‰²å’Œæƒ…ç»ªã€‚
>- Audio å£°éŸ³ï¼š3Dæ¸¸æˆä¸­çš„å£°éŸ³æ¥æºã€‚
>- UI åŸºäºäº‹ä»¶çš„ new UI ç³»ç»Ÿ
>- Particle System ç²’å­ç³»ç»Ÿä¸ç‰¹æ•ˆ

## 2ã€ç¼–ç¨‹å®è·µ

ç‰§å¸ˆä¸é­”é¬¼ åŠ¨ä½œåˆ†ç¦»ç‰ˆ

æœ¬æ¬¡ä½œä¸šéœ€è¦åœ¨ä¸Šæ¬¡ä½œä¸šçš„åŸºç¡€ä¸Šï¼Œå°†åœºè®°ä¸­çš„åŠ¨ä½œåˆ†ç¦»å‡ºæ¥ï¼Œé¦–å…ˆè¦åˆ›å»ºåŠ¨ä½œç®¡ç†å™¨ã€‚
ä¸Šæ¬¡çš„ç‰§å¸ˆä¸æ¶é­”ä¸­ï¼Œæ¶é­”ã€ç‰§å¸ˆã€èˆ¹è¿™ä¸‰ä¸ªæ¸¸æˆå¯¹è±¡ï¼Œç”¨äº†ç‹¬ç«‹çš„ç±»æ¥å®ç°æ“ä½œï¼Œåˆ†åˆ«åˆ›å»ºç±»å¯¹è±¡åï¼Œé€šè¿‡ç”¨æˆ·ä¸ç”¨æˆ·ç•Œé¢çš„äº¤äº’è°ƒç”¨ä¸åŒå¯¹è±¡çš„å‡½æ•°ç‹¬ç«‹å®ç°ç›¸å¯¹åº”çš„æ¸¸æˆå¯¹è±¡çš„è¿åŠ¨ã€‚è€Œæœ¬å‘¨çš„åŠ¨ä½œåˆ†ç¦»ç‰ˆï¼Œéœ€è¦ç”¨åˆ°åŠ¨ä½œç®¡ç†å™¨å’ŒåŠ¨ä½œæ§åˆ¶å™¨ï¼Œä½¿ç”¨åŠ¨ä½œæ§åˆ¶å™¨æ§åˆ¶æ‰€æœ‰æ¸¸æˆå¯¹è±¡çš„è¿åŠ¨æ ·å¼ï¼Œè€Œç”¨æˆ·é€šè¿‡ç”¨æˆ·ç•Œé¢äº¤äº’é€šçŸ¥åŠ¨ä½œç®¡ç†å™¨è°ƒç”¨ä¼ å…¥çš„æ§åˆ¶å™¨å¹¶å®ç°å…¶å†…çš„æ¸¸æˆå¯¹è±¡çš„åŠ¨ä½œã€‚å³åŠ¨ä½œåˆ†ç¦»åç”±ç®¡ç†å™¨ã€æ§åˆ¶å™¨ä¸¤ä¸ªç±»ç®¡ç†åŠ¨ä½œã€‚

åŠ¨ä½œç®¡ç†æ˜¯æ¸¸æˆå†…å®¹çš„é‡è¦å†…å®¹ï¼Œè¿™æ¬¡ä½œä¸šè¦ææ¸…æ¥šç®€å•åŠ¨ä½œçš„ç»„åˆé—®é¢˜ï¼Œå®ç°åŠ¨ä½œç®¡ç†å™¨ï¼Œå®ç°åŸºç¡€åŠ¨ä½œç±»ï¼Œå›è°ƒå®ç°åŠ¨ä½œå®Œæˆé€šçŸ¥ï¼ˆç»å…¸æ–¹æ³•ï¼‰ï¼Œå…¶è§„åˆ’ä¸è®¾è®¡çš„UMLå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191007112524527.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDM3NzY5MQ==,size_16,color_FFFFFF,t_70)
**åŠ¨ä½œåŸºç±»ï¼š**
åŸºç±»åˆ›å»ºäº†åŠ¨ä½œç®¡ç†å™¨çš„åŸºæœ¬å…ƒç´ ï¼Œå®ƒç»§æ‰¿äº†Unityçš„ScriptableObjectç±»ï¼Œè¯¥ç±»æ˜¯ä¸éœ€è¦ç»‘å®šGameObjectå¯¹è±¡çš„å¯ç¼–ç¨‹ç±»ã€‚å…¶ä¸­çš„å±æ€§åŒ…æ‹¬enableï¼ˆåŠ¨ä½œæ˜¯å¦è¿›è¡Œï¼‰ï¼Œdestroyï¼ˆåŠ¨ä½œæ˜¯å¦è¯¥è¢«é”€æ¯ï¼‰ã€‚åŒæ—¶åˆ©ç”¨æ¥å£å®ç°æ¸¸æˆçš„é€šä¿¡ï¼šcallbackã€‚
```javascript
public class SSAction : ScriptableObject            
	{

		public bool enable = true;                      
		public bool destroy = false;                    

		public GameObject gameobject;                   
		public Transform transform;                     
		public ISSActionCallback callback;              

		protected SSAction() {}                        

		public virtual void Start()                    
		{
			throw new System.NotImplementedException();
		}

		public virtual void Update()
		{
			throw new System.NotImplementedException();
		}
	}
```
**ç®€å•åŠ¨ä½œå®ç°ç±»ï¼š**
å®ç°å…·ä½“åŠ¨ä½œï¼Œå°†ä¸€ä¸ªç‰©ä½“ç§»åŠ¨åˆ°ç›®æ ‡ä½ç½®ï¼Œå¹¶é€šçŸ¥ä»»åŠ¡å®Œæˆã€‚å…¶ä¸­GetSSActionå‡½æ•°é€šè¿‡è·å–ç‰©ä½“è¿åŠ¨çš„ç›®çš„åœ°å’Œé€Ÿåº¦ï¼Œè®©unityè‡ªå·±å»ºç«‹ä¸€ä¸ªåŠ¨ä½œç±»ã€‚å½“åŠ¨ä½œå®Œæˆæ—¶é”€æ¯è¯¥åŠ¨ä½œå¹¶å‘Šè¯‰ç®¡ç†è€…åŠ¨ä½œå·²ç»å®Œæˆï¼Œè¿™ä»¥åŠŸèƒ½åœ¨UpDateä¸­å®ç°ï¼Œæ¯•ç«Ÿè¦é€šè¿‡æ¯ä¸€å¸§æ¥åˆ¤æ–­æ˜¯å¦è¯¥ç»“æŸåŠ¨ä½œã€‚
```javascript
public class SSMoveToAction : SSAction                        //ç§»åŠ¨
	{
		public Vector3 target;        
		public float speed;           

		private SSMoveToAction(){}
		public static SSMoveToAction GetSSAction(Vector3 target, float speed) 
		{
			SSMoveToAction action = ScriptableObject.CreateInstance<SSMoveToAction>();
			action.target = target;
			action.speed = speed;
			return action;
		}

		public override void Update() 
		{
			this.transform.position = Vector3.MoveTowards(this.transform.position, target, speed*Time.deltaTime);
			if (this.transform.position == target) 
			{
				this.destroy = true;
				this.callback.SSActionEvent(this);      
			}
		}

		public override void Start() 
		{
			
		}
	}
```
**ç»„åˆåŠ¨ä½œå®ç°ç±»ï¼š**
å®ç°ä¸€ä¸ªåŠ¨ä½œç»„åˆåºåˆ—ï¼Œé¡ºåºæ’­æ”¾åŠ¨ä½œã€‚è®©åŠ¨ä½œç»„åˆç»§æ‰¿æŠ½è±¡åŠ¨ä½œï¼Œèƒ½å¤Ÿè¢«è¿›ä¸€æ­¥ç»„åˆï¼›å®ç°å›è°ƒæ¥å—ï¼Œèƒ½æ¥æ”¶è¢«ç»„åˆåŠ¨ä½œçš„äº‹ä»¶ã€‚åˆ›å»ºä¸€ä¸ªåŠ¨ä½œé¡ºåºæ‰§è¡Œåºåˆ—ï¼Œ-1 è¡¨ç¤ºæ— é™å¾ªç¯ï¼Œstart å¼€å§‹åŠ¨ä½œã€‚Updateæ–¹æ³•æ‰§è¡Œæ‰§è¡Œå½“å‰åŠ¨ä½œã€‚SSActionEvent æ”¶åˆ°å½“å‰åŠ¨ä½œæ‰§è¡Œå®Œæˆï¼Œæ¨ä¸‹ä¸€ä¸ªåŠ¨ä½œï¼Œå¦‚æœå®Œæˆä¸€æ¬¡å¾ªç¯ï¼Œå‡æ¬¡æ•°ã€‚å¦‚å®Œæˆï¼Œé€šçŸ¥è¯¥åŠ¨ä½œçš„ç®¡ç†è€…ã€‚Start æ‰§è¡ŒåŠ¨ä½œå‰ï¼Œä¸ºæ¯ä¸ªåŠ¨ä½œæ³¨å…¥å½“å‰åŠ¨ä½œæ¸¸æˆå¯¹è±¡ï¼Œå¹¶å°†è‡ªå·±ä½œä¸ºåŠ¨ä½œäº‹ä»¶çš„æ¥æ”¶è€…ã€‚OnDestory å¦‚æœè‡ªå·±è¢«æ³¨é”€ï¼Œåº”è¯¥é‡Šæ”¾è‡ªå·±ç®¡ç†çš„åŠ¨ä½œã€‚åœ¨UpDateä¸­æ¯ä¸€å¸§å®Œæˆå½“å‰åŠ¨ä½œï¼Œå½“è¿™ä¸€åºåˆ—çš„åŠ¨ä½œå®Œæˆæ—¶ï¼Œåœæ­¢å¹¶é€šè¿‡å›è°ƒå‡½æ•°å‘Šè¯‰ç®¡ç†è€…è¯¥åºåˆ—åŠ¨ä½œå·²å®Œæˆï¼Œå¹¶åˆ é™¤åºåˆ—ã€‚åœ¨æ‰§è¡ŒåŠ¨ä½œå‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸€ä¸ªåŠ¨ä½œæ³¨å…¥æ¸¸æˆå¯¹è±¡ï¼Œåœ¨Startä¸­å®ç°ã€‚
```javascript
public class SequenceAction: SSAction, ISSActionCallback
	{           
		public List<SSAction> sequence;    
		public int repeat = -1;           
		public int start = 0;              

		public static SequenceAction GetSSAcition(int repeat, int start, List<SSAction> sequence) 
		{
			SequenceAction action = ScriptableObject.CreateInstance<SequenceAction>();
			action.repeat = repeat;
			action.sequence = sequence;
			action.start = start;
			return action;
		}

		public override void Update() 
		{
			if (sequence.Count == 0) return;
			if (start < sequence.Count) 
			{
				sequence[start].Update();     
			}
		}

		public void SSActionEvent(SSAction source, SSActionEventType events = SSActionEventType.Competeted,  
			int intParam = 0, string strParam = null, Object objectParam = null)
		{
			source.destroy = false;          //å…ˆä¿ç•™è¿™ä¸ªåŠ¨ä½œï¼Œå¦‚æœæ˜¯æ— é™å¾ªç¯åŠ¨ä½œç»„åˆä¹‹åè¿˜éœ€è¦ä½¿ç”¨
			this.start++;
			if (this.start >= sequence.Count) 
			{
				this.start = 0;
				if (repeat > 0) repeat--;
				if (repeat == 0) 
				{
					this.destroy = true;              
					this.callback.SSActionEvent(this); 
				}
			}
		}

		public override void Start() 
		{
			foreach(SSAction action in sequence) 
			{
				action.gameobject = this.gameobject;
				action.transform = this.transform;
				action.callback = this;                
				action.Start();
			}
		}

		void OnDestroy() 
		{
			
		}
	}
```
**åŠ¨ä½œç®¡ç†åŸºç±»ï¼š**
é¦–å…ˆå»ºç«‹MonoBehaviorç®¡ç†åŠ¨ä½œï¼ŒåŠ¨ä½œåšå®Œè‡ªåŠ¨å›æ”¶ï¼Œåœ¨è¿™ä¹‹ä¸­å¿…ç„¶æœ‰éœ€è¦ç­‰å¾…çš„åŠ¨ä½œå’Œå·²ç»åšå®Œçš„åŠ¨ä½œï¼Œæ˜¾ç„¶ï¼Œéœ€è¦ç­‰å¾…çš„åŠ¨ä½œåŠ å…¥ç­‰å¾…åˆ—è¡¨ï¼Œéœ€è¦åˆ é™¤çš„åŠ¨ä½œåŠ å…¥åˆ é™¤åˆ—è¡¨ã€‚æä¾›äº†è¿è¡Œä¸€ä¸ªæ–°åŠ¨ä½œçš„æ–¹æ³•RunActionã€‚è¯¥æ–¹æ³•æŠŠæ¸¸æˆå¯¹è±¡ä¸åŠ¨ä½œç»‘å®šï¼Œå¹¶ç»‘å®šè¯¥åŠ¨ä½œäº‹ä»¶çš„æ¶ˆæ¯æ¥æ”¶è€…ã€‚
```javascript
public class SSActionManager: MonoBehaviour, ISSActionCallback                      //actionç®¡ç†å™¨
	{   

		private Dictionary<int, SSAction> actions = new Dictionary<int, SSAction>();    //å°†æ‰§è¡Œçš„åŠ¨ä½œçš„å­—å…¸é›†åˆ,intä¸ºkeyï¼ŒSSActionä¸ºvalue
		private List<SSAction> waitingAdd = new List<SSAction>();                       //ç­‰å¾…å»æ‰§è¡Œçš„åŠ¨ä½œåˆ—è¡¨
		private List<int> waitingDelete = new List<int>();                              //ç­‰å¾…åˆ é™¤çš„åŠ¨ä½œçš„key                

		protected void Update() 
		{
			foreach(SSAction ac in waitingAdd)                                         
			{
				actions[ac.GetInstanceID()] = ac;                                      //è·å–åŠ¨ä½œå®ä¾‹çš„IDä½œä¸ºkey
			}
			waitingAdd.Clear();

			foreach(KeyValuePair<int, SSAction> kv in actions) 
			{
				SSAction ac = kv.Value;
				if (ac.destroy) 
				{
					waitingDelete.Add(ac.GetInstanceID());
				} 
				else if (ac.enable) 
				{
					ac.Update();
				}
			}

			foreach(int key in waitingDelete) 
			{
				SSAction ac = actions[key];
				actions.Remove(key);
				DestroyObject(ac);
			}
			waitingDelete.Clear();
		}

		public void RunAction(GameObject gameobject, SSAction action, ISSActionCallback manager) 
		{
			action.gameobject = gameobject;
			action.transform = gameobject.transform;
			action.callback = manager;                                               
			waitingAdd.Add(action);                                                    
			action.Start();
		}

		public void SSActionEvent(SSAction source, SSActionEventType events = SSActionEventType.Competeted,  
			int intParam = 0, string strParam = null, Object objectParam = null)
		{
			
		}
	}		
```
**judgeï¼š**
```javascript
private int checkGameOver(){
		if (Director.cn_move == 1)
			return 0;
		int from_priest = 0;
		int from_devil = 0;
		int to_priest = 0;
		int to_devil = 0;

		int[] from_count = fromCoast.getCharacterNum ();
		from_priest = from_count [0];
		from_devil = from_count [1];

		int[] to_count = toCoast.getCharacterNum ();
		to_priest = to_count [0];
		to_devil = to_count [1];

		if (to_devil + to_priest == 6)
			return 1;//you win
		int[] boat_count = boat.getCharacterNum();
		if (boat.getTFflag () == 1) {
			from_priest += boat_count [0];
			from_devil += boat_count [1];
		} else {
			to_priest += boat_count [0];
			to_devil += boat_count [1];
		}
		if (from_priest < from_devil && from_priest > 0)
			return -1;//you lose
		if(to_priest < to_devil && to_priest > 0)
			return -1;//you lose
		return 0;//not yet finish
	}
```

**ISSActionCallbackæ¥å£**
```javascript
public enum SSActionEventType : int { Started, Competeted }  

public interface ISSActionCallback  
{  
    void SSActionEvent(SSAction source, SSActionEventType events = SSActionEventType.Competeted,  
        int intParam = 0, string strParam = null, Object objectParam = null);  
} 
```

å®šä¹‰äº†äº‹ä»¶å¤„ç†æ¥å£ï¼Œæ‰€æœ‰äº‹ä»¶ç®¡ç†è€…éƒ½å¿…é¡»å®ç°è¿™ä¸ªæ¥å£æ¥å®ç°äº‹ä»¶è°ƒåº¦ã€‚åˆ©ç”¨æ¥å£ï¼ˆISSACtionCallbackï¼‰å®ç°æ¶ˆæ¯é€šçŸ¥ï¼Œé¿å…ä¸åŠ¨ä½œç®¡ç†è€…ç›´æ¥ä¾èµ–ã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191007134918208.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDM3NzY5MQ==,size_16,color_FFFFFF,t_70)
- æœ€å
å®Œæ•´ä»£ç è§GitHubï¼Œå°±ä¸è´´äº†ã€‚
[è§†é¢‘é“¾æ¥-loseğŸ”—](https://pan.baidu.com/s/1rbntiNgW3kaTMD1t7XpCXw)
[è§†é¢‘é“¾æ¥-winğŸ”—](https://pan.baidu.com/s/1UG4IHtZutOqjBo6Fm_zFiw)
[æˆ‘çš„Githubä»£ç ä¼ é€é—¨](https://github.com/ZhengweiZhao/Unity3D-HW2)

